# ğŸ“˜ Improving Image Synthesis with Diffusion-Negative Sampling (DNP)

## 1. ê°œìš” (Overview)

* **ì œëª©**: Improving Image Synthesis with Diffusion-Negative Sampling
* **ì €ì**: Alakh Desai, Nuno Vasconcelos
* **ì†Œì†**: UC San Diego (SVCL)
* **í•™íšŒ**: ECCV 2024
* **ë§í¬**: [arXiv](https://arxiv.org/abs/2411.05473) / [arXiv HTML](https://arxiv.org/html/2411.05473v1) / [Papers with Code](https://paperswithcode.com/search?q=Improving%20Image%20Synthesis%20with%20Diffusion-Negative%20Sampling)

> **ì„ ì • ì´ìœ **: Negative promptê°€ íš¨ê³¼ì ì´ì§€ë§Œ â€œì¢‹ì€ negativeë¥¼ ì‚¬ëŒì´ ì°¾ê¸° ì–´ë µë‹¤â€ëŠ” ê·¼ë³¸ ë¬¸ì œë¥¼ **semantic gap(ì¸ê°„ vs DM ë‚´ë¶€ ì˜ë¯¸ê³µê°„)**ìœ¼ë¡œ í•´ì„í•˜ê³ , **ëª¨ë¸ì´ ì§ì ‘ ë§Œë“  â€˜ì§„ì§œ negative ìƒ˜í”Œâ€™(least-compliant)**ì„ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜í•´ negative promptë¡œ ì“°ëŠ” DNP íŒŒì´í”„ë¼ì¸ì„ ì œì•ˆí•œë‹¤.
> ì¦‰, â€œì‚¬ëŒì´ negativeë¥¼ ì˜ ì“°ê²Œ í›ˆë ¨ì‹œí‚¤ê¸°â€ê°€ ì•„ë‹ˆë¼ â€œëª¨ë¸ì´ ë‚©ë“í•˜ëŠ” negativeë¥¼ ë¨¼ì € ë½‘ê³  ì¸ê°„ ì–¸ì–´ë¡œ ë²ˆì—­â€í•˜ëŠ” ë°©í–¥.

---

## 2. ë¬¸ì œ ì •ì˜ (Problem Formulation)

**ë¬¸ì œ ë° ê¸°ì¡´ í•œê³„**:

* ì¼ë°˜ì ì¸ Negative Promptingì€ íš¨ê³¼ê°€ ìˆìœ¼ë‚˜, **ì–´ë–¤ negativeê°€ ì¢‹ì€ì§€ íƒìƒ‰ì´ ì–´ë µê³ ** í”„ë¡¬í”„íŠ¸/ì‹œë“œì— ë”°ë¼ ë¶ˆì•ˆì •í•¨.
* ê·¸ ì´ìœ ë¥¼ â€œì‚¬ëŒì´ ìƒê°í•˜ëŠ” negativeâ€ì™€ â€œë””í“¨ì „ ëª¨ë¸ì´ ë‚´ë¶€ì ìœ¼ë¡œ ë¶„ë¦¬í•˜ëŠ” ê°œë…â€ ì‚¬ì´ì˜ **semantic gap**ìœ¼ë¡œ ì„¤ëª…:

  * ì‚¬ëŒì´ ì§ê´€ì ìœ¼ë¡œ ì“´ negativeëŠ” DM ë‚´ë¶€ì—ì„œ â€˜ì§„ì§œë¡œâ€™ í™•ë¥ ì„ ë‚®ì¶”ëŠ” ë°©í–¥ì´ ì•„ë‹ ìˆ˜ ìˆìŒ.

**ì œì•ˆ ë°©ì‹**:

* **DNS (Diffusion-Negative Sampling)**: ì£¼ì–´ì§„ positive prompt (p)ì— ëŒ€í•´ **ê°€ì¥ ëœ ë”°ë¥´ëŠ”(least-compliant)** ì´ë¯¸ì§€ (x^-)ë¥¼ ìƒ˜í”Œë§í•˜ëŠ” ì ˆì°¨ë¥¼ ì •ì˜.
* **DNP (Diffusion-Negative Prompting)**:

  1. DNSë¡œ (x^-)ë¥¼ ìƒì„±
  2. (x^-)ë¥¼ ì‚¬ëŒì´(ë˜ëŠ” ìº¡ì…”ë„ˆê°€) ì„¤ëª…í•´ negative prompt (n^*) ìƒì„±
  3. ìµœì¢… ìƒì„±ì€ ((p, n^*))ë¡œ ìˆ˜í–‰

> â€» **í•µì‹¬ ê°œë… ì •ì˜**

* **Negative Prompting(NP)**: â€œì´ë¯¸ì§€ì— í¬í•¨ë˜ë©´ ì•ˆ ë˜ëŠ” ë‚´ìš©â€ì„ í…ìŠ¤íŠ¸ë¡œ ë„£ì–´ ìƒì„± ë°©í–¥ì„ ì œì–´.
* **DNS**: â€œí…ìŠ¤íŠ¸ë¥¼ ì˜ ë”°ë¥´ëŠ” ìƒ˜í”Œâ€ì´ ì•„ë‹ˆë¼, **í…ìŠ¤íŠ¸ë¥¼ ê°€ì¥ ëœ ë”°ë¥´ëŠ” ìƒ˜í”Œì„ ì¼ë¶€ëŸ¬ ë½‘ëŠ”** sampling.
* **DNP**: DNSë¡œ ì–»ì€ â€œëª¨ë¸ ê¸°ì¤€ negative ì´ë¯¸ì§€â€ë¥¼ í…ìŠ¤íŠ¸ë¡œ ë²ˆì—­í•´, ê·¸ í…ìŠ¤íŠ¸ë¥¼ negative promptë¡œ ì‚¬ìš©.

---

## 3. ëª¨ë¸ êµ¬ì¡° (Architecture)

### ì „ì²´ êµ¬ì¡°

![ëª¨ë¸ êµ¬ì¡°](assets/dnp_pipeline.png)

* **ì…ë ¥**: positive prompt (p)
* **DNS Chain**: (p)ì— ëŒ€í•´ least-compliant ì´ë¯¸ì§€ (x^-) ìƒì„±
* **Captioning**: (x^- \rightarrow n^*)
* **NP Chain**: ((p, n^*))ë¡œ ìµœì¢… ì´ë¯¸ì§€ ìƒì„±

---

### ğŸ’  í•µì‹¬ ëª¨ë“ˆ ë˜ëŠ” êµ¬ì„± ìš”ì†Œ

#### ğŸ“Œ DNS (Diffusion-Negative Sampling)

* ëª©í‘œ: (p)ì— ëŒ€í•œ **prompt adherenceê°€ ë‚®ì€ ìƒ˜í”Œ**ì„ ì˜ë„ì ìœ¼ë¡œ ìƒì„±
* ì§ê´€: CFGê°€ â€œ(p)ë¥¼ ë” ì˜ ë”°ë¥´ë„ë¡â€ í™•ë¥  ì§ˆëŸ‰ì„ ì´ë™ì‹œí‚¤ëŠ” ë°˜ë©´, DNSëŠ” â€œ(p)ë¥¼ ëœ ë”°ë¥´ëŠ” ìª½â€ì„ ê°•ì¡°
* ì‹¤ë¬´ì  ê´€ì (ìš”ì§€): NPë¥¼ ì§€ì›í•˜ëŠ” ëª¨ë¸ì—ì„œ **(positiveë¥¼ ë¹„ìš°ê³ , negativeì— (p)ë¥¼ ë„£ëŠ” í˜•íƒœë¡œ) DNS íš¨ê³¼ë¥¼ ìœ ë„**í•  ìˆ˜ ìˆë‹¤ê³  ì„¤ëª…

#### ğŸ“Œ DNP / auto-DNP

* (x^-)ë¥¼ ì‚¬ëŒì´ ì„¤ëª…í•˜ë©´ (n^*)ê°€ ë˜ê³ , ê·¸ê²Œ DM ë‚´ë¶€ ì˜ë¯¸ê³µê°„ì—ì„œ ë” â€œì§„ì§œ negativeâ€ë¡œ ì‘ë™
* **auto-DNP**: ìº¡ì…”ë„ˆ(ì˜ˆ: BLIP2)ë¡œ (x^- \to n^*)ë¥¼ ìë™í™”

---

## âš–ï¸ ê¸°ì¡´ ëª¨ë¸ê³¼ì˜ ë¹„êµ

| í•­ëª©        | ë³¸ ë…¼ë¬¸(DNP)                          | ê¸°ì¡´ ë°©ë²•1(CFG)  | ê¸°ì¡´ ë°©ë²•2(ìˆ˜ë™ Negative Prompting) |
| --------- | ---------------------------------- | ------------ | ----------------------------- |
| â€œë„¤ê±°í‹°ë¸Œâ€ ì›ì²œ | **ëª¨ë¸ì´ ë§Œë“  least-compliant ìƒ˜í”Œì—ì„œ ìœ ë„** | ì—†ìŒ           | ì‚¬ëŒì´ ì§ì ‘ ì‘ì„±                     |
| ì¶”ê°€ ëª¨ë“ˆ     | (auto-DNPë©´) ìº¡ì…”ë„ˆ í•„ìš”                 | ì—†ìŒ           | ì—†ìŒ                            |
| ì¥ì         | DM ë‚´ë¶€ ì˜ë¯¸ê³µê°„ì— ë§ëŠ” negativeë¥¼ ì œê³µ        | ë‹¨ìˆœ/ë¹ ë¦„        | ì¼€ì´ìŠ¤ì— ë”°ë¼ ê°•ë ¥                    |
| í•œê³„        | ìº¡ì…”ë„ˆ ì˜¤ë¥˜/ì •ë³´ ì†ì‹¤ ê°€ëŠ¥                    | adherence í•œê³„ | íƒìƒ‰ ë‚œì´ë„/ë¶ˆì•ˆì •                    |

---

## ğŸ“‰ ì‹¤í—˜ ë° ê²°ê³¼

* **ë°ì´í„°ì…‹/ë²¤ì¹˜**(ë…¼ë¬¸ì—ì„œ ë‹¤ë£¨ëŠ” ë²”ì£¼):

  * ë³µì¡ í”„ë¡¬í”„íŠ¸(ê´€ê³„/ë°°ì¹˜), ì¸ì²´/ì†(H&H ë¥˜), ë‹¤ì–‘í•œ í…ìŠ¤íŠ¸ ë²¤ì¹˜
* **ë¹„êµ ëª¨ë¸**:

  * SD/SDXL baseline(CFG), ìˆ˜ë™ NP, Attend-and-Exciteë¥˜ ê²°í•© ë“±ê³¼ ë¹„êµ
* **ì£¼ìš” ì„±ëŠ¥ ì§€í‘œ**:

  * CLIP score, Inception Score(IS), (ë²¤ì¹˜ì— ë”°ë¼) human preference(ì •í™•ì„±/í’ˆì§ˆ ì„ í˜¸)

| ëª¨ë¸                 | Accuracy | F1 | BLEU | ê¸°íƒ€                   |
| ------------------ | -------- | -- | ---- | -------------------- |
| ë³¸ ë…¼ë¬¸(DNP/auto-DNP) | -        | -  | -    | CLIP/IS/ì‚¬ëŒ ì„ í˜¸ ê°œì„ (ë³´ê³ ) |
| ê¸°ì¡´ SOTA            | -        | -  | -    | baseline/ê¸°ì¡´ ê¸°ë²• ëŒ€ë¹„    |

> ì‹¤í—˜ ìš”ì•½(í•µì‹¬ ë©”ì‹œì§€): DNSë¡œ ë½‘ì€ negative ìƒ˜í”Œì„ ì–¸ì–´ë¡œ ë²ˆì—­í•´ negativeë¡œ ì“°ë©´, **â€œì‚¬ëŒì´ ë– ì˜¬ë¦° negativeâ€ë³´ë‹¤ prompt adherence/í’ˆì§ˆì´ ë” ì•ˆì •ì ìœ¼ë¡œ ê°œì„ **ëœë‹¤ëŠ” ê²ƒì„ ì •ì„±/ì •ëŸ‰/ì‚¬ëŒí‰ê°€ë¡œ ë³´ì—¬ì¤Œ.

---

## âœ… ì¥ì  ë° í•œê³„

## **ì¥ì **:

* **training-free** (í•™ìŠµ ì—†ì´ ì ìš©)
* â€œì¢‹ì€ negativeë¥¼ ì°¾ê¸° ì–´ë ¤ì›€â€ì„ **ëª¨ë¸ ë‚´ë¶€ì—ì„œ negativeë¥¼ ì°¾ëŠ” ë°©ì‹**ìœ¼ë¡œ êµ¬ì¡°ì ìœ¼ë¡œ í•´ê²°
* ì—¬ëŸ¬ diffusion ë³€í˜•/ê°€ì´ë˜ìŠ¤ ê¸°ë²•ê³¼ ì¡°í•© ê°€ëŠ¥

## **í•œê³„ ë° ê°œì„  ê°€ëŠ¥ì„±**:

* auto-DNPëŠ” **ì´ë¯¸ì§€â†’í…ìŠ¤íŠ¸ ë³€í™˜(ìº¡ì…”ë‹) ì†ì‹¤/ì˜¤ë¥˜** ê°€ëŠ¥
* DNS + ìµœì¢… ìƒì„±ìœ¼ë¡œ **ì¶”ê°€ sampling ë¹„ìš©** ë°œìƒ
* negative promptê°€ â€œstep ì „ì²´ì— í•˜ë‚˜ë¡œ ê³ ì •â€ë˜ëŠ” êµ¬ì¡°ë¼ step-wise ìµœì ì„±ì€ ë³´ì¥ ì–´ë ¤ì›€ (â†’ ANSWERê°€ ì—¬ê¸°ë¥¼ ì§ì ‘ ê³µê²©)

---

## ğŸ§  TL;DR â€“ í•œëˆˆì— ìš”ì•½

> **ëª¨ë¸ì´ ìƒê°í•˜ëŠ” â€˜ì§„ì§œ negativeâ€™(least-compliant ì´ë¯¸ì§€)ë¥¼ ë¨¼ì € ë½‘ê³ , ê·¸ê±¸ í…ìŠ¤íŠ¸ë¡œ ë°”ê¿” negative promptë¡œ ì¨ì„œ ìƒì„± í’ˆì§ˆ/ì •í•©ì„±ì„ ì˜¬ë¦°ë‹¤.**

| êµ¬ì„± ìš”ì†Œ  | ì„¤ëª…                                                     |
| ------ | ------------------------------------------------------ |
| í•µì‹¬ ëª¨ë“ˆ  | DNS(least-compliant sampling) + DNP(ìº¡ì…˜ ê¸°ë°˜ negative ìƒì„±) |
| í•™ìŠµ ì „ëµ  | í•™ìŠµ ì—†ìŒ(training-free)                                   |
| ì „ì´ ë°©ì‹  | NP/CFG ì§€ì› DMì— ì‰½ê²Œ ê²°í•©                                    |
| ì„±ëŠ¥/íš¨ìœ¨ì„± | ê°œì„  ë³´ê³ , ëŒ€ì‹  ìº¡ì…”ë„ˆ/ì¶”ê°€ ìƒ˜í”Œë§ ë¹„ìš© ë° ìº¡ì…˜ ì†ì‹¤ ë¦¬ìŠ¤í¬                    |

---

## ğŸ”— ì°¸ê³  ë§í¬ (References)

* [ğŸ“„ arXiv ë…¼ë¬¸](https://arxiv.org/abs/2411.05473)
* [ğŸ“„ arXiv HTML](https://arxiv.org/html/2411.05473v1)
* [ğŸ“ˆ Papers with Code](https://paperswithcode.com/search?q=Improving%20Image%20Synthesis%20with%20Diffusion-Negative%20Sampling)

## ë‹¤ìŒ ë…¼ë¬¸:

* **ANSWER** â€“ DNPì˜ â€œìº¡ì…˜ ì†ì‹¤/ì™¸ë¶€ ë¦¬ì†ŒìŠ¤/ë‹¨ì¼ negative ê°€ì •â€ì„ ì œê±°í•˜ê³ , **ìƒ˜í”Œë§ ë£¨í”„ ë‚´ë¶€ì—ì„œ step-wise negativeë¥¼ ì§ì ‘ êµ¬ì„±**í•˜ëŠ” ë°©í–¥.

---

---

# ğŸ“˜ Diffusion Models with Adaptive Negative Sampling Without External Resources (ANSWER)

## 1. ê°œìš” (Overview)

* **ì œëª©**: Diffusion Models with Adaptive Negative Sampling Without External Resources
* **ì €ì**: Alakh Desai, Nuno Vasconcelos
* **ì†Œì†**: UC San Diego (SVCL)
* **í•™íšŒ**: ICCV 2025
* **ë§í¬**: [arXiv](https://arxiv.org/abs/2508.02973) / [PDF(CVF)](https://openaccess.thecvf.com/content/ICCV2025/papers/Desai_Guiding_Diffusion_Models_with_Adaptive_Negative_Sampling_Without_External_Resources_ICCV_2025_paper.pdf) / [arXiv HTML](https://arxiv.org/html/2508.02973v1) / [Papers with Code](https://paperswithcode.com/search?q=Adaptive%20Negative%20Sampling%20Without%20External%20Resources)

> **ì„ ì • ì´ìœ **: DNPëŠ” (DNS ì´ë¯¸ì§€ â†’ ìº¡ì…˜ â†’ negative í…ìŠ¤íŠ¸) êµ¬ì¡°ë¼ **ì™¸ë¶€ ìº¡ì…”ë„ˆ/ì •ë³´ ì†ì‹¤/stepë³„ ìµœì  negative ë¶€ì¬** ë¬¸ì œê°€ ë‚¨ëŠ”ë‹¤. ANSWERëŠ” ì´ë¥¼ ì—†ì• ê¸° ìœ„í•´ **â€œnegative promptë¥¼ ë§Œë“¤ì§€ ì•Šê³ â€**, sampling step ë‚´ë¶€ì—ì„œ **DNS mini-chainìœ¼ë¡œ ì–»ì€ â€˜negative ë…¸ì´ì¦ˆ(Îµâ»)â€™ë¥¼ ì§ì ‘ ì‚¬ìš©**í•œë‹¤. ì¦‰, ì™„ì „íˆ **inference-time / training-free**ë¡œ â€œhuman negative ì‘ì„±â€ ì—†ì´ë„ negationì„ í™œìš©í•œë‹¤.

---

## 2. ë¬¸ì œ ì •ì˜ (Problem Formulation)

**ë¬¸ì œ ë° ê¸°ì¡´ í•œê³„**:

* **ë‹¨ì¼ negative prompt ê°€ì •ì˜ í•œê³„**: diffusionì˜ stepì´ ë°”ë€Œë©´ latent/ë…¸ì´ì¦ˆ ìƒíƒœê°€ ë‹¬ë¼ì§€ë¯€ë¡œ â€œìµœì  negativeâ€ë„ step-wiseë¡œ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŒ.
* DNPëŠ” negativeë¥¼ ì–»ê¸° ìœ„í•´ **ìº¡ì…˜(ì™¸ë¶€ ëª¨ë¸) + í…ìŠ¤íŠ¸ ë³€í™˜ ì†ì‹¤**ì´ í•„ì—°ì .
* â€œì™„ì „í•œ DNPâ€(stepë§ˆë‹¤ DNSâ†’ìº¡ì…˜) ê°™ì€ ê·¹ë‹¨ì€ **ë¹„ìš©ì´ ê³¼ë„í•˜ê³ **, í›„ë°˜ë¶€ì—ì„œëŠ” ìº¡ì…˜ì´ ì˜¤íˆë ¤ ì•„í‹°íŒ©íŠ¸ ì–µì œì— ë°©í•´ê°€ ë  ìˆ˜ ìˆìŒ(ë…¼ë¬¸ ë¬¸ì œì˜ì‹).

**ì œì•ˆ ë°©ì‹**:

* **ANSWER(Adaptive Negative Sampling Without External Resources)**:

  * ì™¸ë¶€ ìº¡ì…”ë„ˆ/negative í…ìŠ¤íŠ¸ ì—†ì´
  * ë§¤ stepì—ì„œ **DNSë¥¼ Kâ‚œë²ˆë§Œ ì§§ê²Œ êµ´ë ¤** ì–»ì€ â€œnegative surrogate ë…¸ì´ì¦ˆâ€ë¥¼
  * í˜„ì¬ stepì˜ uncond ë…¸ì´ì¦ˆ í†µê³„ë¡œ **Normalize**í•œ ë’¤
  * ê·¸ê±¸ CFG/NP ì—…ë°ì´íŠ¸ì— ê·¸ëŒ€ë¡œ ë„£ëŠ”ë‹¤.

> â€» **í•µì‹¬ ê°œë… ì •ì˜**

* **DNS mini-chain**: â€œnegative ìƒ˜í”Œë§â€ì„ ì „ì²´ ìƒì„± 1íšŒê°€ ì•„ë‹ˆë¼ **stepë§ˆë‹¤ Kâ‚œ stepë§Œ ì§§ê²Œ** ìˆ˜í–‰
* **Normalize(Â·, t)**: DNSê°€ NPë³´ë‹¤ â€œK step ì•ì„  ì‹œì â€ì˜ ë…¸ì´ì¦ˆë¥¼ ë§Œë“¤ê¸° ë•Œë¬¸ì— ìƒê¸°ëŠ” **í†µê³„ mismatch**ë¥¼ í‰ê· /ë¶„ì‚° ë§¤ì¹­ìœ¼ë¡œ ë³´ì •
* **Kâ‚œ ìŠ¤ì¼€ì¤„**: ì´ˆë°˜(êµ¬ì¡° í˜•ì„± êµ¬ê°„)ì— í¬ê²Œ, í›„ë°˜(ë””í…Œì¼/ì•„í‹°íŒ©íŠ¸ êµ¬ê°„)ì—ëŠ” 0ìœ¼ë¡œ ì¤„ì—¬ ë¹„ìš©/ë¶€ì‘ìš©ì„ ì œì–´

---

## 3. ëª¨ë¸ êµ¬ì¡° (Architecture)

### ì „ì²´ êµ¬ì¡°

![ëª¨ë¸ êµ¬ì¡°](assets/answer_arch.png)

* **ì…ë ¥/ì¶œë ¥ íë¦„**

  * ì…ë ¥: prompt (p), ì´ˆê¸° ë…¸ì´ì¦ˆ (z_T)
  * ë§¤ step (t)ì—ì„œ:

    1. í˜„ì¬ (z_t)ë¡œ uncond/cond ë…¸ì´ì¦ˆ ì˜ˆì¸¡((\epsilon_\phi^t, \epsilon_p^t))
    2. **DNS mini-chain**ìœ¼ë¡œ (t_n)ì—ì„œì˜ negative ë…¸ì´ì¦ˆ (\epsilon^{-,t_n}) íšë“
    3. Normalizeë¡œ (\epsilon^{-,t_n})ë¥¼ (t) í†µê³„ë¡œ ë§¤ì¹­ â†’ (\epsilon_{\text{neg}}^t)
    4. (\epsilon_{\text{neg}}^t)ë¥¼ ê¸°ì¤€ì ìœ¼ë¡œ CFG ì—…ë°ì´íŠ¸ ìˆ˜í–‰
    5. scheduler stepìœ¼ë¡œ (z_{t-1})ë¡œ ì´ë™

---

### ğŸ’  í•µì‹¬ ëª¨ë“ˆ ë˜ëŠ” êµ¬ì„± ìš”ì†Œ

#### ğŸ“Œ DNS mini-chainìœ¼ë¡œ Îµâ» ì¶”ì • (step-wise)

* í˜„ì¬ step (t)ì—ì„œ ì‹œì‘í•´ **Kâ‚œë²ˆì˜ ì§§ì€ DNS ë¡¤ì•„ì›ƒ**ì„ ìˆ˜í–‰í•˜ì—¬ â€œë¯¸ë˜ ì‹œì â€ (t_n)ì˜ negative surrogateë¥¼ ì–»ìŒ
* ì§ê´€:

  * CFGë§Œ ì“°ë©´ â€œuncond ê¸°ì¤€ì â€ì´ ê³ ì •(í˜¹ì€ ë‹¨ìˆœ negative prompt)ì— ë¨¸ë¬´ë¥´ëŠ”ë°,
  * ANSWERëŠ” step-wiseë¡œ â€œëª¨ë¸ì´ ë‚´ë¶€ì ìœ¼ë¡œ ë§Œë“œëŠ” negation ë°©í–¥â€ì„ ê°±ì‹ í•´ì„œ ì“°ëŠ” íš¨ê³¼

#### ğŸ“Œ Normalize(Â·, t): í†µê³„ ë§¤ì¹­ìœ¼ë¡œ blur ë°©ì§€

DNSëŠ” NP(ë©”ì¸ ì²´ì¸)ë³´ë‹¤ **K step ahead**ì— í•´ë‹¹í•˜ëŠ” (t_n)ì—ì„œì˜ Îµë¥¼ ì“°ë¯€ë¡œ,
ê·¸ëŒ€ë¡œ ì“°ë©´ ë¶„í¬ê°€ ë‹¬ë¼ **ë°°ê²½/ì§ˆê°ì´ ë­‰ê°œì§€ëŠ” blur**ê°€ ìƒê¸¸ ìˆ˜ ìˆìŒ.

ê·¸ë˜ì„œ í‰ê· /í‘œì¤€í¸ì°¨ë¥¼ ë§¤ì¹­:

```math
\text{Normalize}(x; \mu_r,\sigma_r)
= \frac{x-\mu_x}{\sigma_x}\sigma_r+\mu_r
```

* ì—¬ê¸°ì„œ (x = \epsilon^{-,t_n})
* (r = \epsilon_\phi^t) (í˜„ì¬ stepì˜ uncond/neg ì˜ˆì¸¡)
* ì¦‰, DNS ê²°ê³¼ë¥¼ â€œí˜„ì¬ step í†µê³„â€ì— ë§ì¶° ì•ˆì •í™”

#### ğŸ“Œ Kâ‚œ ìŠ¤ì¼€ì¤„: ì´ˆë°˜ë§Œ ê°•í•˜ê²Œ, í›„ë°˜ì€ CFGë¡œ

* ì´ˆë°˜: í° êµ¬ì¡°/ë°°ì¹˜ ê²°ì • â†’ ANSWERê°€ ë„ì›€
* í›„ë°˜: ë””í…Œì¼/í…ìŠ¤ì²˜/ì•„í‹°íŒ©íŠ¸ â†’ DNS mismatch ë¶€ì‘ìš©(blur) ê°€ëŠ¥ì„±ì´ ì»¤ì ¸ì„œ (K_t \to 0)
* êµ¬í˜„ì ìœ¼ë¡œëŠ” `t > T/2` ê°™ì€ êµ¬ê°„ì—ì„œë§Œ DNSë¥¼ ì¼œëŠ” í˜•íƒœê°€ ëŒ€í‘œì 

---

## âš–ï¸ ê¸°ì¡´ ëª¨ë¸ê³¼ì˜ ë¹„êµ

| í•­ëª©                  | ë³¸ ë…¼ë¬¸(ANSWER)                     | ê¸°ì¡´ ë°©ë²•1(CFG) | ê¸°ì¡´ ë°©ë²•2(DNP)    | ê¸°ì¡´ ë°©ë²•3(Complete DNP; step-wise caption) |
| ------------------- | -------------------------------- | ----------- | -------------- | --------------------------------------- |
| ëª…ì‹œì  negative prompt | ë¶ˆí•„ìš”                              | ë¶ˆí•„ìš”         | í•„ìš”((n^*))      | í•„ìš”((n_t^*))                             |
| ì™¸ë¶€ ë¦¬ì†ŒìŠ¤(ìº¡ì…”ë„ˆ)         | **ì—†ìŒ**                           | ì—†ìŒ          | ìˆìŒ             | ìˆìŒ(ë§¤ step í˜¸ì¶œ)                           |
| step-wise ì ì‘        | **ì˜ˆ (Îµ ê¸°ë°˜)**                     | ì œí•œì          | ë³´í†µ â€œë‹¨ì¼ (n^*)â€  | ì˜ˆ(í•˜ì§€ë§Œ ë¹„ì‹¸ê³  ë¶ˆì•ˆì •)                          |
| ë¹„ìš©                  | ì¶”ê°€ DNS(Kâ‚œ)                       | ë‚®ìŒ          | DNS 1íšŒ + ìµœì¢… ìƒì„± | ë§¤ìš° í¼                                    |
| ë¶€ì‘ìš©                 | K ê³¼ëŒ€ ì‹œ mismatchâ†’blur ê°€ëŠ¥(ì •ê·œí™”ë¡œ ì™„í™”) | ìƒëŒ€ì  ì•ˆì •      | ìº¡ì…˜ ì†ì‹¤/ì˜¤ë¥˜       | ìº¡ì…˜ ì˜¤ë¥˜/í›„ë°˜ ì•…í™” ê°€ëŠ¥                          |

---

## ğŸ“‰ ì‹¤í—˜ ë° ê²°ê³¼

* **ë°ì´í„°ì…‹/ë²¤ì¹˜**:

  * Pick-a-Pic, DrawBench, PartiPrompts, Attend-and-Excite ì„¸íŒ…, ImageNet ë“± ë‹¤ì–‘í•œ í…ìŠ¤íŠ¸ ë²¤ì¹˜ì—ì„œ ë¹„êµ
* **ë¹„êµ ëª¨ë¸**:

  * SDXL(CFG), DNP, (ë³€í˜• ê°€ì´ë˜ìŠ¤/ê¸°ë²•) ë“±
* **ì£¼ìš” ì„±ëŠ¥ ì§€í‘œ**:

  * CLIP score, FID, IS, ImageReward, HPSv2, human preference(ì„ í˜¸/ìŠ¹ë¥ )

| ëª¨ë¸           | Accuracy | F1 | BLEU | ê¸°íƒ€                                       |
| ------------ | -------- | -- | ---- | ---------------------------------------- |
| ë³¸ ë…¼ë¬¸(ANSWER) | -        | -  | -    | ë‹¤ìˆ˜ ë²¤ì¹˜ì—ì„œ CFG/DNP ëŒ€ë¹„ ìš°ìˆ˜(ë³´ê³ ), ì‚¬ëŒ ì„ í˜¸ â€œ2xâ€ ì£¼ì¥ |
| ê¸°ì¡´ SOTA      | -        | -  | -    | baseline/ê¸°ì¡´ ê¸°ë²•                           |

> ì‹¤í—˜ í•´ì„(í•µì‹¬ ë©”ì‹œì§€):
> *DNPì˜ â€œnegativeë¥¼ í…ìŠ¤íŠ¸ë¡œ ë§Œë“¤ê¸°â€ë¥¼ ë²„ë¦¬ê³ , sampling ë‚´ë¶€ì—ì„œ negative ë…¸ì´ì¦ˆë¥¼ ì§ì ‘ ë§Œë“¤ê³  ì •ê·œí™”í•´ ì“°ë©´, ì™¸ë¶€ ëª¨ë¸ ì—†ì´ë„ ì—¬ëŸ¬ ë²¤ì¹˜ì—ì„œ ì„±ëŠ¥/ì„ í˜¸ê°€ ê°œì„ ëœë‹¤.*
> ë˜í•œ **Normalizeê°€ blurë¥¼ ì¤„ì´ëŠ” í•µì‹¬**ì´ë©°, **Kê°€ ë„ˆë¬´ í¬ë©´ ì˜¤íˆë ¤ í’ˆì§ˆì´ ë–¨ì–´ì§ˆ ìˆ˜ ìˆì–´ Kâ‚œ ìŠ¤ì¼€ì¤„ì´ ì¤‘ìš”**í•˜ë‹¤ê³  ê°•ì¡°í•œë‹¤.

---

## âœ… ì¥ì  ë° í•œê³„

## **ì¥ì **:

* **ì™„ì „ inference-time / training-free**
* **ì™¸ë¶€ ìº¡ì…”ë„ˆ/negative prompt ì—†ì´** DM ë‚´ë¶€ negationì„ í™œìš©
* step-wiseë¡œ negative surrogateë¥¼ êµ¬ì„±í•´, â€œë‹¨ì¼ negative ê°€ì •â€ì„ ì™„í™”
* CFG ì§€ì› ëª¨ë¸ì´ë©´ ì ìš© ê°€ëŠ¥(ì¼ë°˜ì„± ê°•ì¡°)

## **í•œê³„ ë° ê°œì„  ê°€ëŠ¥ì„±**:

* DNSê°€ â€œK step aheadâ€ì¸ êµ¬ì¡°ë¼, **í†µê³„ mismatchë¡œ blur**ê°€ ìƒê¸¸ ìˆ˜ ìˆìŒ â†’ Normalizeë¡œ ì™„í™”í•˜ë‚˜ íŠ¸ë ˆì´ë“œì˜¤í”„ ì¡´ì¬
* Kâ‚œ ìŠ¤ì¼€ì¤„/í•˜ì´í¼íŒŒë¼ë¯¸í„° ì„ íƒì´ íœ´ë¦¬ìŠ¤í‹±ì— ì˜ì¡´ (ìë™í™” ì—¬ì§€)
* sampler/stepsì— ë”°ë¼ íš¨ê³¼ê°€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆì–´ êµ¬í˜„ ì •í•©ì„±(ìŠ¤ì¼€ì¤„ëŸ¬ ìƒíƒœ/ì¸ë±ìŠ¤)ì´ ì¤‘ìš”

---

## ğŸ§  TL;DR â€“ í•œëˆˆì— ìš”ì•½

> **ë§¤ stepì—ì„œ DNSë¥¼ ì§§ê²Œ(Kâ‚œ) ëŒë ¤ ì–»ì€ â€˜negative ë…¸ì´ì¦ˆâ€™ë¥¼ ì •ê·œí™”í•´ CFG ì—…ë°ì´íŠ¸ì— ì§ì ‘ ì‚¬ìš©í•¨ìœ¼ë¡œì¨, ì™¸ë¶€ ë¦¬ì†ŒìŠ¤ ì—†ì´ë„ prompt adherence/í’ˆì§ˆì„ ê°œì„ í•˜ëŠ” training-free sampling ê¸°ë²•.**

| êµ¬ì„± ìš”ì†Œ  | ì„¤ëª…                                                   |
| ------ | ---------------------------------------------------- |
| í•µì‹¬ ëª¨ë“ˆ  | step-wise DNS mini-chain + Normalize(í†µê³„ ë§¤ì¹­) + Kâ‚œ ìŠ¤ì¼€ì¤„ |
| í•™ìŠµ ì „ëµ  | í•™ìŠµ ì—†ìŒ(training-free)                                 |
| ì „ì´ ë°©ì‹  | CFG ì§€ì› diffusion ëª¨ë¸ì— ì ìš© ê°€ëŠ¥                           |
| ì„±ëŠ¥/íš¨ìœ¨ì„± | ì—¬ëŸ¬ ë²¤ì¹˜ì—ì„œ ê°œì„  ë³´ê³ , K ê³¼ëŒ€ ì‹œ blur íŠ¸ë ˆì´ë“œì˜¤í”„(ì •ê·œí™”/ìŠ¤ì¼€ì¤„ë¡œ ì œì–´)       |

---

## ğŸ”— ì°¸ê³  ë§í¬ (References)

* [ğŸ“„ arXiv ë…¼ë¬¸](https://arxiv.org/abs/2508.02973)
* [ğŸ“„ arXiv HTML](https://arxiv.org/html/2508.02973v1)
* [ğŸ“„ CVF PDF (ICCV 2025)](https://openaccess.thecvf.com/content/ICCV2025/papers/Desai_Guiding_Diffusion_Models_with_Adaptive_Negative_Sampling_Without_External_Resources_ICCV_2025_paper.pdf)
* [ğŸ“ˆ Papers with Code](https://paperswithcode.com/search?q=Adaptive%20Negative%20Sampling%20Without%20External%20Resources)

## ë‹¤ìŒ ë…¼ë¬¸:

* **Attend-and-Excite** / **Universal Negative Guidance (NAG)** â€” â€œnegation/ì œì–´â€ ê´€ì ì—ì„œ ANSWERì™€ ë¹„êµ ì¶•ì´ ì¢‹ê³ , ë„¤ê°€ í•˜ë ¤ëŠ” â€œVLM verifier + step-wise guidanceâ€ ì•„ì´ë””ì–´ë¥¼ êµ¬ì¡°ì ìœ¼ë¡œ ì„¤ê³„í•  ë•Œ ì°¸ê³ í•˜ê¸° ì¢‹ìŒ.
